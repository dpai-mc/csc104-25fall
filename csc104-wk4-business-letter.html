<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Week 4: Creating Business Letters in MS Word</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* Define custom font family and color variables for Tailwind */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8;
            color: #383838;
        }
        /* Style for the currently active transcript line */
        .transcript-highlight {
            background-color: #EADDD7;
        }
        /* Custom focus ring color to match the theme */
        .focus-ring-theme {
            --tw-ring-color: #EADDD7;
        }
    </style>
</head>
<body class="antialiased">

    <a href="#main-content" class="absolute -top-40 left-0 bg-white p-3 m-3 text-gray-700 focus:top-0 focus:z-50 focus:ring-2 focus:ring-offset-2 focus-ring-theme rounded">Skip to Main Content</a>

    <main id="main-content" class="container mx-auto max-w-4xl p-4 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-[#383838]">Week 4: Creating Business Letters in MS Word</h1>
            <p class="mt-2 text-lg">This guide covers the essentials of formatting professional business letters using Microsoft Word's built-in tools and templates.</p>
        </header>
        
        <section class="mb-8 shadow-lg rounded-lg overflow-hidden">
            <div class="aspect-w-16 aspect-h-9 bg-black">
                <iframe id="youtube-player" src="https://www.youtube.com/embed/VIDEO_ID_PLACEHOLDER?enablejsapi=1" title="YouTube video player" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="w-full h-full"></iframe>
            </div>
        </section>

        <section class="transcript">
            <details class="border border-[#EADDD7] rounded-lg" open>
                <summary role="button" aria-expanded="true" class="p-4 font-bold text-xl cursor-pointer list-none focus:outline-none focus:ring-2 focus-ring-theme rounded-t-lg hover:bg-[#F0EBE8]">
                    Video Transcript
                </summary>
                <div id="transcript-content" class="transcript-content p-4 border-t border-[#EADDD7] max-h-80 overflow-y-auto">
                    <p data-start="0.5" tabindex="0" class="p-2 cursor-pointer rounded transition-colors duration-200 hover:bg-[#F0EBE8] focus:outline-none focus:ring-2 focus-ring-theme">
                        <span class="font-bold text-sm block">00:00</span>
                        Hello and welcome to week four. This week, we're focusing on a fundamental skill: creating professionally formatted business letters in Microsoft Word.
                    </p>
                    <p data-start="9.2" tabindex="0" class="p-2 cursor-pointer rounded transition-colors duration-200 hover:bg-[#F0EBE8] focus:outline-none focus:ring-2 focus-ring-theme">
                        <span class="font-bold text-sm block">00:09</span>
                        First, let's explore Word's built-in templates. Go to File, then New, and you'll see a search bar. Type "business letter" to find a variety of pre-designed options.
                    </p>
                    <p data-start="18.5" tabindex="0" class="p-2 cursor-pointer rounded transition-colors duration-200 hover:bg-[#F0EBE8] focus:outline-none focus:ring-2 focus-ring-theme">
                        <span class="font-bold text-sm block">00:18</span>
                        While templates are great, it's crucial to understand the underlying formatting. We'll start with a blank document to build one from scratch.
                    </p>
                    <p data-start="25.0" tabindex="0" class="p-2 cursor-pointer rounded transition-colors duration-200 hover:bg-[#F0EBE8] focus:outline-none focus:ring-2 focus-ring-theme">
                        <span class="font-bold text-sm block">00:25</span>
                        A key component is the letterhead. This includes your name, address, and contact information. We will use the Header and Footer tools to create a consistent letterhead.
                    </p>
                    <p data-start="34.8" tabindex="0" class="p-2 cursor-pointer rounded transition-colors duration-200 hover:bg-[#F0EBE8] focus:outline-none focus:ring-2 focus-ring-theme">
                        <span class="font-bold text-sm block">00:34</span>
                        Next is the date. Instead of typing it manually, use the 'Insert Date & Time' feature. This allows you to insert a field that can update automatically, which is a very useful trick.
                    </p>
                    <p data-start="45.1" tabindex="0" class="p-2 cursor-pointer rounded transition-colors duration-200 hover:bg-[#F0EBE8] focus:outline-none focus:ring-2 focus-ring-theme">
                        <span class="font-bold text-sm block">00:45</span>
                        After the date, you'll add the recipient's information, followed by the salutation, such as "Dear Mr. Smith:". Pay close attention to spacing and punctuation.
                    </p>
                    <p data-start="55.3" tabindex="0" class="p-2 cursor-pointer rounded transition-colors duration-200 hover:bg-[#F0EBE8] focus:outline-none focus:ring-2 focus-ring-theme">
                        <span class="font-bold text-sm block">00:55</span>
                        The body of the letter should be clear and concise. Use single spacing within paragraphs and double spacing between them for readability.
                    </p>
                     <p data-start="63.0" tabindex="0" class="p-2 cursor-pointer rounded transition-colors duration-200 hover:bg-[#F0EBE8] focus:outline-none focus:ring-2 focus-ring-theme">
                        <span class="font-bold text-sm block">01:03</span>
                        Finally, we'll cover the closing, like "Sincerely," followed by a few blank lines for a signature, and then your typed name. This structure is critical for maintaining a professional tone.
                    </p>
                </div>
            </details>
        </section>
    </main>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Load the IFrame Player API code asynchronously.
            const tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            const firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        });

        let player;
        // This function creates an <iframe> (and YouTube player) after the API code downloads.
        function onYouTubeIframeAPIReady() {
            const playerElement = document.getElementById('youtube-player');
            // Check if the placeholder has been replaced with a real URL
            if (playerElement && !playerElement.src.includes('VIDEO_ID_PLACEHOLDER')) {
                player = new YT.Player('youtube-player', {
                    events: {
                        'onReady': onPlayerReady
                    }
                });
            } else {
                console.warn("YouTube Player could not be initialized. Please replace 'VIDEO_ID_PLACEHOLDER' with a valid YouTube video ID.");
            }
        }

        // The API will call this function when the video player is ready.
        function onPlayerReady(event) {
            const transcriptContainer = document.getElementById('transcript-content');
            const transcriptPs = transcriptContainer.querySelectorAll('p[data-start]');
            let activePara = null;

            // Function to highlight the current transcript paragraph based on video time
            const highlightTranscript = () => {
                const currentTime = player.getCurrentTime();
                if (isNaN(currentTime)) return;

                // Find the current paragraph
                let currentPara = null;
                for (let i = 0; i < transcriptPs.length; i++) {
                    const p = transcriptPs[i];
                    const nextP = transcriptPs[i + 1];
                    const startTime = parseFloat(p.getAttribute('data-start'));
                    const endTime = nextP ? parseFloat(nextP.getAttribute('data-start')) : player.getDuration();
                    
                    if (currentTime >= startTime && currentTime < endTime) {
                        currentPara = p;
                        break;
                    }
                }

                if (currentPara && currentPara !== activePara) {
                    // Remove highlight from the previously active paragraph
                    if (activePara) {
                        activePara.classList.remove('transcript-highlight');
                    }
                    // Add highlight to the new active paragraph
                    currentPara.classList.add('transcript-highlight');
                    activePara = currentPara;
                    
                    // Scroll the active paragraph into the center of the view
                    activePara.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            };

            // Check the time and update the highlight periodically
            setInterval(highlightTranscript, 500);

            // Add event listeners to each transcript paragraph to control the video
            transcriptPs.forEach(p => {
                const seekToTime = () => {
                    const time = parseFloat(p.getAttribute('data-start'));
                    if (!isNaN(time)) {
                        player.seekTo(time, true);
                        player.playVideo();
                    }
                };
                
                p.addEventListener('click', seekToTime);
                p.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault(); // Prevent page scroll on spacebar
                        seekToTime();
                    }
                });
            });
        }
    </script>
</body>
</html>
