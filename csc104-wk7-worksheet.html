<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Updated Title for Week 7 -->
    <title>CSC104 - Week 7: Introduction to Excel Worksheets</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500&display=swap" rel="stylesheet">

    <style>
        body {
            background-color: #FDFBF8;
            color: #383838;
            font-family: 'Inter', sans-serif;
        }
        
        .code-font {
            font-family: 'Fira Code', monospace;
        }
        
        /* Style for the currently active transcript line */
        .active-transcript-line {
            background-color: #F0EBE8;
            font-weight: 600;
            color: #000;
            border-left: 4px solid #4a5568; /* Darker accent for active line */
        }

        /* Skip link style (Accessibility requirement) */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: #383838;
            color: #FDFBF8;
            padding: 8px;
            z-index: 100;
            transition: top 0.3s;
        }

        .skip-link:focus {
            top: 0;
        }

        /* Custom scrollbar for transcript */
        #transcript-container::-webkit-scrollbar {
            width: 8px;
        }
        #transcript-container::-webkit-scrollbar-thumb {
            background-color: #cccccc;
            border-radius: 10px;
        }
        #transcript-container::-webkit-scrollbar-thumb:hover {
            background-color: #a0a0a0;
        }
    </style>
</head>
<body class="p-4 sm:p-8">
    <a href="#main-content" class="skip-link rounded-br-md">Skip to main content</a>
    
    <div id="main-content" class="max-w-7xl mx-auto">
        <header class="mb-8">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-800 mb-2">CSC104 - Week 7: Introduction to Excel Worksheets</h1>
            <p class="text-lg text-gray-600">Welcome to Week 7! This week, we transition from word processing in Microsoft Word to data management and calculation in **Microsoft Excel**. This introductory session covers the basic structure and environment of an Excel Worksheet.</p>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Video Player Section - Used 'aspect-video' for responsive 16:9 ratio -->
            <section class="lg:sticky lg:top-8 self-start">
                <h2 class="text-2xl font-semibold mb-4 text-gray-700">Video Lecture: Exploring the Excel Environment</h2>
                <!-- Video Embed with the new ID and settings -->
                <div class="aspect-video w-full rounded-xl overflow-hidden shadow-2xl">
                    <iframe id="youtube-player"
                            width="100%" height="auto"
                            src="https://www.youtube.com/embed/_PYugf8v5M0?si=VulBJDys2jDlgens&enablejsapi=1" 
                            title="YouTube video player"
                            frameborder="0" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                            allowfullscreen
                            class="w-full h-full"></iframe>
                </div>
                <p class="mt-4 text-sm text-gray-500">Video ID: <span class="code-font">_PYugf8v5M0</span></p>
            </section>

            <!-- Interactive Transcript Section (Updated for ADA compliance) -->
            <section>
                <h2 class="text-2xl font-semibold mb-4 text-gray-700">Video Transcript</h2>
                <div id="transcript-container" class="h-96 overflow-y-scroll bg-white p-4 rounded-xl shadow-inner border border-gray-200">
                    <p class="text-center text-gray-400">Loading transcript...</p>
                    <!-- Transcript lines will be injected here -->
                </div>
                <p class="mt-4 text-sm text-gray-600">Click any line in the transcript or use the **Enter/Space** keys when focused to jump to that moment in the video.</p>
            </section>
        </main>
    </div>

    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', () => {
            // --- Configuration ---
            const videoId = '_PYugf8v5M0'; // New video ID
            let player;
            let timeUpdater;
            let parsedTranscript = [];

            // Updated transcript content (parsed from the csc104-wk7-worksheet.srt file)
            const transcriptData = `1
00:00:00,640 --> 00:00:08,880
Aloha and welcome to week seven of computer applications and this week we're going to

2
00:00:08,880 --> 00:00:15,600
start with Excel. Okay so Excel is our second topic. Our first topic really was Microsoft Word

3
00:00:15,600 --> 00:00:19,020
and this we're going to talk about Excel which is a spreadsheet program

4
00:00:19,020 --> 00:00:27,320
meaning it's tabular. It does a lot of calculations. If I were to open Excel

5
00:00:27,320 --> 00:00:36,660
I have a blank workbook here. You'll see basically we have rows and columns and we put stuff in the

6
00:00:36,660 --> 00:00:40,420
rows and columns and it makes it easy to add things up, multiply, divide, do a lot of other

7
00:00:40,420 --> 00:00:48,800
different things. Okay and it was built around originally around accounting software really.

8
00:00:48,800 --> 00:00:54,720
In this particular first week we're just talking about the environment, the Excel

9
00:00:54,720 --> 00:01:00,340
worksheet itself. We're not doing any functions, we're not doing any formulas.

10
00:01:00,340 --> 00:01:04,500
We're really just working on the environment, putting data in,

11
00:01:04,500 --> 00:01:10,240
making it look good, using some of the features of Excel, but no calculations.

12
00:01:10,240 --> 00:01:13,900
The calculations come in next week, the second week of Excel.

13
00:01:13,900 --> 00:01:19,160
So what you're seeing here is a typical Excel window. You can see up here in the

14
00:01:19,160 --> 00:01:23,940
upper left hand corner is what's called the name box. It tells you where you are,

15
00:01:23,940 --> 00:01:30,280
what the currently active cell is. So I'm in A1, if I click here I'm in B3,

16
00:01:30,280 --> 00:01:35,760
if I click here I'm in C5. It gives you the column name and the row number.

17
00:01:35,760 --> 00:03:07,320
And it shows it up here in the name box, which is good. Over here is what's called the formula bar, which when you put data in and you click enter, it actually shows up in the formula bar. If I type data in, and I type in the formula bar, it shows up in the cell, and vice versa. It's really the same thing. And if you want to edit it, you click on the cell, and you click up here in the formula bar and you can edit. Or you can double click on the cell and you can edit right in the cell. And you'll notice in Excel that when you put data in and you click enter, it usually goes down and selects the cell right below where you just entered. And if I put in a name and I hit enter, it goes right below. If I put in a value, it goes right below. You can see that it's aligning to the right. When it's numbers, it usually aligns to the right, and when it's text, it usually aligns to the left. You can change the alignment of any cell, just like you do in Word, using the alignment tools in the Home tab. In the Home tab, you have a Font group, you have an Alignment group, you have a Number group, which is where you can change the formats, which we'll talk a little bit about in a minute. You have Styles, Cells and Editing. So it looks similar to Word, but the groups are a little bit different for Excel.

38
00:03:07,320 --> 00:03:13,680
Okay, so let's talk about the structure of the worksheet. The columns are named with letters.

39
00:03:13,680 --> 00:03:17,400
The rows are named with numbers.

40
00:03:17,400 --> 00:03:22,500
And if you go all the way over, you can see how far this goes.

41
00:03:22,500 --> 00:03:26,820
If I hold down the control key and I use the right arrow,

42
00:03:26,820 --> 00:03:31,840
it'll go all the way to the end of the worksheet, which is XFD.

43
00:03:31,840 --> 00:03:36,440
Now, I don't know why it's XFD, but that's what it is, that's what Excel names it.

44
00:03:36,440 --> 00:03:39,400
And then if I use the left arrow,

45
00:03:39,400 --> 00:03:43,460
it goes all the way back to the beginning of the worksheet, which is A.

46
00:03:43,460 --> 00:04:47,400
And you can use those movement keys to move around. If you go to the bottom, the last row is $1,048,576$. That's a lot of rows. You won't have to worry about running out of room on the worksheet. And you can use the up arrow to go back to the top of the worksheet, which is A1, the beginning cell. There are multiple worksheets in a workbook, and the default is sheet one, sheet two, sheet three. You can rename those sheets by double-clicking and changing the names. So if you have one on finances, you could change it to finances. If you have one on personal, you could change it to personal. You can have as many sheets as you like in a workbook. And a workbook is the Excel file itself. So the file, what we used to call a file, is now called a workbook. Okay, so let's talk about the different formats that you can have. As I said, you have a number tab, a number group in the Home tab. And you can change the format of the data in the cell. So if I have this number here, I can change it to currency, or accounting. Currency puts the dollar sign right next to the number. Accounting aligns the dollar sign to the left of the cell, and the number to the right. They both look good. They're just a little bit different. Okay, and you're going to use those when you do the assignment for this week, the assignment in the online environment, and then the MS Word projects do also this week, so don't forget about that one. Okay, and then we will do is for, I think four weeks of Excel. I think I posted them. Yeah, but there's formulas and functions next week. And then the week after that is large worksheets, charting, what-if, and then financial functions. We'll talk a little bit about what those are when we do that, and then there'll be a week where we'll have just a project for that week, and that'll finish up our Excel. Okay, and then we'll do the last part, we'll do PowerPoint, okay? So that's the outline for the rest of the semester. So get started with Excel. The first week is just an introduction to the environment, and I hope you have a great week. Thank you.`;

            // --- Utility Functions ---

            // Converts time string (HH:MM:SS,ms) to seconds
            function timeToSeconds(timeStr) {
                if (!timeStr) return 0;
                const parts = timeStr.replace(',', '.').split(':');
                const hours = parseInt(parts[0]) || 0;
                const minutes = parseInt(parts[1]) || 0;
                const seconds = parseFloat(parts[2]) || 0;
                return hours * 3600 + minutes * 60 + seconds;
            }

            // Parses SRT data into an array of objects
            function parseSrt(srtText) {
                const lines = srtText.trim().split('\n');
                const cues = [];
                let currentCue = null;

                for (const line of lines) {
                    if (line.match(/^\d+$/)) {
                        // Start of a new cue (sequence number)
                        if (currentCue) {
                            cues.push(currentCue);
                        }
                        currentCue = { number: parseInt(line), text: [] };
                    } else if (line.includes('-->') && currentCue) {
                        // Timestamps
                        const [startTimeStr, endTimeStr] = line.split(' --> ');
                        currentCue.start = timeToSeconds(startTimeStr.trim());
                        currentCue.end = timeToSeconds(endTimeStr.trim());
                    } else if (line.trim() !== '' && currentCue) {
                        // Dialogue text
                        currentCue.text.push(line.trim());
                    }
                }
                // Push the last cue
                if (currentCue) {
                    cues.push(currentCue);
                }

                // Join text array into a single string
                return cues.map(cue => ({
                    ...cue,
                    text: cue.text.join(' ')
                }));
            }

            // Populates the transcript container - updated for ADA compliance
            function populateTranscript() {
                const container = document.getElementById('transcript-container');
                container.innerHTML = '';

                parsedTranscript.forEach((cue, index) => {
                    // Use a div with role="button" and tabindex="0" for keyboard focus/interaction
                    const lineElement = document.createElement('div');
                    lineElement.className = 'transcript-line p-2 cursor-pointer hover:bg-gray-100 rounded-lg text-base focus:outline-none focus:ring-2 focus:ring-gray-400';
                    lineElement.dataset.start = cue.start;
                    lineElement.dataset.end = cue.end;
                    lineElement.dataset.index = index;
                    lineElement.textContent = cue.text;
                    
                    // ADA: Role and Tabindex for making it keyboard focusable
                    lineElement.setAttribute('role', 'button');
                    lineElement.setAttribute('tabindex', '0');
                    lineElement.setAttribute('aria-label', `Jump to ${Math.floor(cue.start)} seconds: ${cue.text.substring(0, 50)}...`);

                    const seekToTime = () => {
                        if (player && player.seekTo) {
                            player.seekTo(cue.start, true);
                            player.playVideo();
                        }
                    };

                    lineElement.addEventListener('click', seekToTime);
                    
                    // ADA: Handle Enter and Space keys
                    lineElement.addEventListener('keydown', (event) => {
                        if (event.key === 'Enter' || event.key === ' ') {
                            event.preventDefault(); // Prevent default scroll for spacebar
                            seekToTime();
                        }
                    });

                    container.appendChild(lineElement);
                });
            }

            // Highlights the current line and scrolls it into view
            function highlightCurrentLine() {
                if (!player || !player.getCurrentTime) return;

                const currentTime = player.getCurrentTime();
                const lines = document.querySelectorAll('.transcript-line');
                let foundActive = false;

                lines.forEach(line => {
                    const start = parseFloat(line.dataset.start);
                    const end = parseFloat(line.dataset.end);

                    if (currentTime >= start && currentTime < end) {
                        if (!line.classList.contains('active-transcript-line')) {
                            // Deactivate previous active line
                            document.querySelector('.active-transcript-line')?.classList.remove('active-transcript-line');
                            // Activate current line
                            line.classList.add('active-transcript-line');
                            
                            // Scroll line into view if it's not already visible
                            const container = document.getElementById('transcript-container');
                            const containerRect = container.getBoundingClientRect();
                            const lineRect = line.getBoundingClientRect();

                            // Only scroll if the line is partially or completely outside the view
                            if (lineRect.top < containerRect.top || lineRect.bottom > containerRect.bottom) {
                                line.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }
                        }
                        foundActive = true;
                    } else {
                        line.classList.remove('active-transcript-line');
                    }
                });

                // If playback stops, clear highlighting after the last line's duration
                if (!foundActive && player.getPlayerState() !== YT.PlayerState.PLAYING) {
                     document.querySelector('.active-transcript-line')?.classList.remove('active-transcript-line');
                }
            }


            // --- YouTube Player API Functions ---
            window.onYouTubeIframeAPIReady = function() {
                player = new YT.Player('youtube-player', {
                    videoId: videoId,
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange
                    }
                });
            };

            function onPlayerReady(event) {
                console.log('YouTube player is ready.');
            }

            function onPlayerStateChange(event) {
                clearInterval(timeUpdater); // Clear any existing interval
                if (event.data === YT.PlayerState.PLAYING) {
                    timeUpdater = setInterval(highlightCurrentLine, 300);
                }
            }
            
            // --- Initialization ---\
            function initialize() {
                parsedTranscript = parseSrt(transcriptData);
                populateTranscript();
                
                // Load the YouTube IFrame Player API script if it's not already loaded
                if (typeof(YT) == 'undefined' || typeof(YT.Player) == 'undefined') {
                    const tag = document.createElement('script');
                    tag.src = "https://www.youtube.com/iframe_api";
                    const firstScriptTag = document.getElementsByTagName('script')[0];
                    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
                } else {
                    onYouTubeIframeAPIReady();
                }
                
                console.log('Introduction page initialized.');
            }

            initialize();
        });
    </script>
</body>
</html>
